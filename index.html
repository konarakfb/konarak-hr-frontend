<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Konarak HR - Working Test</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body { font-family: Arial; padding: 20px; background: #f2f4f7;}
h1 { text-align:center; }
.card { background:white; padding:15px; border-radius:8px; max-width:600px; margin:auto; box-shadow:0 0 10px rgba(0,0,0,0.1); }
input,button { width:100%; padding:12px; margin-top:10px; font-size:16px; }
button { background:#007bff; color:white; border:none; border-radius:6px; }
table { width:100%; margin-top:20px; border-collapse:collapse; }
th,td { border:1px solid #ddd; padding:10px; }
th { background:#007bff; color:white; }
</style>

</head>
<body>

<h1>Konarak HR System (Working Version)</h1>

<div class="card">
    <h3>Add Employee</h3>
    <input id="emp_code" placeholder="Employee Code (KFB001)">
    <input id="first_name" placeholder="First Name">
    <input id="last_name" placeholder="Last Name">
    <input id="email" placeholder="Email">
    <input id="phone" placeholder="Phone Number">

    <button onclick="createEmployee()">SAVE EMPLOYEE</button>
</div>

<div class="card">
    <h3>Employees List</h3>
    <button onclick="listEmployees()">REFRESH LIST</button>

    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Code</th>
                <th>Name</th>
                <th>Email</th>
            </tr>
        </thead>
        <tbody id="empTable"></tbody>
    </table>
</div>

<script>
// Backend details
const API_URL = "https://script.google.com/macros/s/AKfycbxaco_JdbFYgkIueNMVhVIwvCUSa_ZE-QQAT3UtV2B9r-fww7agGTkNsqwSk5301sMWEg/exec";
const API_KEY = "konarak123456789secret";

// GET call
async function apiGet(params){
    const url = new URL(API_URL);
    for(const k in params){ url.searchParams.append(k, params[k]); }
    url.searchParams.append("key", API_KEY);

    const res = await fetch(url);
    return res.json();
}

// POST call
async function apiPost(body){
    body.key = API_KEY;

    const res = await fetch(API_URL, {
        method: "POST",
        headers:{ "Content-Type":"application/json" },
        body: JSON.stringify(body)
    });

    return res.json();
}

// Add employee
async function createEmployee(){
    const data = {
        action:"create_employee",
        emp_code: emp_code.value,
        first_name: first_name.value,
        last_name: last_name.value,
        email: email.value,
        phone: phone.value,
        status: "active"
    };

    const r = await apiPost(data);

    if(r.success){
        alert("Employee saved! ID = " + r.id);
        listEmployees();
    } else {
        alert("ERROR: " + r.error);
    }
}

// List employees
async function listEmployees(){
    const r = await apiGet({action:"list_employees"});
    const tbody = document.getElementById("empTable");
    tbody.innerHTML = "";

    r.data.forEach(emp => {
        tbody.innerHTML += `
            <tr>
                <td>${emp.id}</td>
                <td>${emp.emp_code}</td>
                <td>${emp.first_name} ${emp.last_name}</td>
                <td>${emp.email}</td>
            </tr>
        `;
    });
}
</script>

</body>
</html>
